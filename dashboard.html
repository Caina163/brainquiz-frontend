<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Painel Inicial - BrainQuiz</title>
  <style>
    body {
      background: linear-gradient(135deg, #000 0%, #1a1a2e 50%, #16213e 100%);
      color: #0af;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Particles Animation */
    .particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: -1;
    }
    
    .particle {
      position: absolute;
      width: 2px;
      height: 2px;
      background: #0af;
      border-radius: 50%;
      animation: float 8s infinite linear;
      box-shadow: 0 0 10px #0af;
    }
    
    @keyframes float {
      0% {
        transform: translateY(100vh) translateX(0px);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      90% {
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) translateX(100px);
        opacity: 0;
      }
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto 20px;
      background: rgba(17, 17, 17, 0.8);
      padding: 20px 30px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      border: 2px solid rgba(0, 170, 255, 0.3);
      box-shadow: 0 0 30px rgba(0, 170, 255, 0.2);
    }
    
    h1 {
      margin: 0;
      text-shadow: 0 0 20px #0af;
      font-size: 2.5rem;
      animation: pulse 3s infinite;
    }

    @keyframes pulse {
      0%, 100% { text-shadow: 0 0 20px #0af; }
      50% { text-shadow: 0 0 40px #0af, 0 0 60px #0af; }
    }
    
    .header-buttons {
      display: flex;
      gap: 15px;
      align-items: center;
    }
    
    #createQuizBtn, #exitBtn {
      background: linear-gradient(45deg, #0af, #08c);
      border: none;
      border-radius: 10px;
      padding: 12px 24px;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 5px 20px rgba(0, 170, 255, 0.3);
      transition: all 0.3s ease;
      display: inline-block;
    }
    
    #createQuizBtn:hover, #exitBtn:hover {
      background: linear-gradient(45deg, #08c, #0af);
      color: #fff;
      box-shadow: 0 8px 30px rgba(0, 170, 255, 0.6);
      transform: translateY(-3px);
    }
    
    #exitBtn {
      background: linear-gradient(45deg, #ff4444, #cc0000);
      box-shadow: 0 5px 20px rgba(255, 68, 68, 0.3);
    }
    
    #exitBtn:hover {
      background: linear-gradient(45deg, #cc0000, #ff4444);
      box-shadow: 0 8px 30px rgba(255, 68, 68, 0.6);
    }
    
    #tabs {
      max-width: 1200px;
      margin: 0 auto 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      background: rgba(17, 17, 17, 0.6);
      padding: 15px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 170, 255, 0.2);
    }
    
    .tab-button {
      background: rgba(34, 34, 34, 0.8);
      border: none;
      border-radius: 10px;
      padding: 12px 20px;
      color: #0af;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(0, 170, 255, 0.2);
      font-weight: bold;
      transition: all 0.3s ease;
      flex-shrink: 0;
    }
    
    .tab-button.active, .tab-button:hover {
      background: linear-gradient(45deg, #0af, #08c);
      color: #000;
      box-shadow: 0 8px 25px rgba(0, 170, 255, 0.4);
      transform: translateY(-2px);
    }
    
    #quizzesContainer {
      max-width: 1200px;
      margin: 0 auto;
      min-height: 200px;
    }
    
    .section-container {
      margin-bottom: 40px;
    }
    
    .section-title {
      color: #0af;
      font-size: 1.8rem;
      margin: 0 0 20px 0;
      text-shadow: 0 0 15px #0af;
      border-bottom: 3px solid #0af;
      padding-bottom: 10px;
      text-align: center;
      background: linear-gradient(90deg, transparent, rgba(0,170,255,0.1), transparent);
      padding: 15px;
      border-radius: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 170, 255, 0.3);
    }
    
    .section-actions {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .items-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 30px;
      justify-content: center;
    }
    
    .empty-section {
      text-align: center;
      color: #666;
      font-style: italic;
      padding: 40px;
      background: rgba(0,170,255,0.05);
      border-radius: 10px;
      border: 2px dashed rgba(0,170,255,0.3);
      backdrop-filter: blur(5px);
    }

    .quiz-card, .user-card, .pdf-card, .perfil-card {
      background: rgba(17, 17, 17, 0.9);
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(0,170,255,0.2);
      padding: 20px;
      width: 280px;
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid rgba(0,170,255,0.3);
      backdrop-filter: blur(10px);
    }
    
    .quiz-card:hover, .user-card:hover, .pdf-card:hover, .perfil-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 35px rgba(0,170,255,0.4);
      border-color: #0af;
    }
    
    .quiz-title, .user-title, .pdf-card-name, .perfil-title {
      font-weight: bold;
      font-size: 1.2rem;
      margin-bottom: 15px;
      color: #0af;
      text-shadow: 0 0 5px rgba(0,170,255,0.5);
    }
    
    .quiz-image {
      width: 100%;
      height: 150px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 15px;
      border: 2px solid rgba(0,170,255,0.3);
    }
    
    .user-photo {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      margin: 0 auto 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(45deg, #0af, #08c);
      color: #000;
      font-weight: bold;
      font-size: 2rem;
      overflow: hidden;
      border: 3px solid rgba(0,170,255,0.5);
    }
    
    .user-photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .user-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: bold;
      text-transform: uppercase;
    }
    
    .badge-administrador {
      background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
      color: #000;
    }
    
    .badge-moderador {
      background: linear-gradient(45deg, #ffa726, #ffcc02);
      color: #000;
    }
    
    .badge-aluno {
      background: linear-gradient(45deg, #66bb6a, #81c784);
      color: #000;
    }
    
    .gear-menu {
      position: absolute;
      top: 15px;
      right: 15px;
      width: 35px;
      height: 35px;
      background: linear-gradient(45deg, #0af, #08c);
      border-radius: 50%;
      cursor: pointer;
      z-index: 20;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(0,170,255,0.4);
      transition: all 0.3s ease;
    }
    
    .gear-menu:hover {
      transform: rotate(90deg) scale(1.1);
      box-shadow: 0 6px 20px rgba(0,170,255,0.6);
    }
    
    .gear-menu::before {
      content: '⚙️';
      font-size: 16px;
    }
    
    .menu-options {
      display: none;
      position: absolute;
      top: 50px;
      right: 15px;
      background: rgba(26, 26, 26, 0.95);
      border-radius: 10px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.8);
      padding: 10px;
      z-index: 30;
      min-width: 180px;
      border: 1px solid rgba(0,170,255,0.3);
      backdrop-filter: blur(10px);
    }
    
    .menu-options button {
      background: transparent;
      border: none;
      color: #0af;
      padding: 10px 15px;
      width: 100%;
      text-align: left;
      cursor: pointer;
      font-size: 0.9rem;
      border-radius: 6px;
      transition: all 0.2s ease;
      margin-bottom: 5px;
    }
    
    .menu-options button:hover:enabled {
      background: linear-gradient(45deg, #0af, #08c);
      color: #000;
      font-weight: bold;
    }
    
    .menu-options button:disabled {
      color: #555;
      cursor: not-allowed;
    }
    
    .menu-options button.danger {
      color: #ff4444;
    }
    
    .menu-options button.danger:hover:enabled {
      background: linear-gradient(45deg, #ff4444, #cc0000);
      color: #fff;
    }
    
    .empty-message {
      font-style: italic;
      color: #666;
      width: 100%;
      text-align: center;
      margin-top: 40px;
      padding: 40px;
      background: rgba(0,170,255,0.05);
      border-radius: 15px;
      border: 2px dashed rgba(0,170,255,0.2);
      backdrop-filter: blur(5px);
    }
    
    .loading {
      text-align: center;
      color: #0af;
      font-style: italic;
      padding: 40px;
      animation: pulse 2s infinite;
    }
    
    .error {
      color: #ff4444;
      background: rgba(255, 68, 68, 0.1);
      padding: 15px;
      border-radius: 10px;
      margin: 10px 0;
      border: 1px solid rgba(255, 68, 68, 0.3);
      backdrop-filter: blur(5px);
    }
    
    #mensagemSucesso {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #0af, #08c);
      color: #000;
      padding: 15px 25px;
      border-radius: 10px;
      font-weight: bold;
      box-shadow: 0 8px 25px rgba(0,170,255,0.4);
      z-index: 1000;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    #mensagemSucesso.show {
      opacity: 1;
      transform: translateX(0);
    }
    
    .user-actions {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .user-actions button {
      flex: 1 1 auto;
      background: linear-gradient(45deg, #0af, #08c);
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      color: #000;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.85rem;
    }
    
    .user-actions button:hover:enabled {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(0,170,255,0.4);
    }
    
    .user-actions button:disabled {
      background: #333;
      color: #666;
      cursor: not-allowed;
    }
    
    .user-actions button.danger {
      background: linear-gradient(45deg, #ff4444, #cc0000);
      color: #fff;
    }

    /* PDF Card Styles */
    .pdf-card {
      cursor: default;
    }
    
    .pdf-icon {
      width: 100%;
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      color: #ff4444;
      background: rgba(255, 68, 68, 0.1);
      border-radius: 10px;
      margin-bottom: 15px;
      border: 2px solid rgba(255, 68, 68, 0.3);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .pdf-icon:hover {
      background: rgba(255, 68, 68, 0.2);
      transform: scale(1.05);
    }
    
    .pdf-status {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin: 10px 0;
      padding: 8px;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: bold;
    }
    
    .pdf-locked {
      background: rgba(255, 193, 7, 0.2);
      color: #ffc107;
      border: 1px solid rgba(255, 193, 7, 0.3);
    }
    
    .pdf-unlocked {
      background: rgba(40, 167, 69, 0.2);
      color: #28a745;
      border: 1px solid rgba(40, 167, 69, 0.3);
    }

    /* Upload Button */
    .upload-btn {
      background: linear-gradient(45deg, #28a745, #20c997);
      border: none;
      border-radius: 8px;
      padding: 12px 20px;
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
      transition: all 0.3s ease;
    }
    
    .upload-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.6);
    }

    /* Calendar Styles */
    .calendar-container {
      background: rgba(17, 17, 17, 0.9);
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 8px 25px rgba(0,170,255,0.2);
      border: 1px solid rgba(0,170,255,0.3);
      backdrop-filter: blur(10px);
      overflow-x: auto;
    }

    .calendar-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      font-size: 0.9rem;
    }

    .calendar-table th,
    .calendar-table td {
      padding: 12px 15px;
      text-align: center;
      border: 2px solid rgba(0, 170, 255, 0.3);
    }

    .calendar-table th {
      background: linear-gradient(45deg, #0af, #08c);
      color: #000;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .calendar-table td {
      background: rgba(34, 34, 34, 0.8);
      color: #0af;
    }

    .period-header {
      background: linear-gradient(45deg, #ffa726, #ffcc02) !important;
      color: #000 !important;
      font-weight: bold;
    }

    .current-period {
      background: linear-gradient(45deg, #28a745, #20c997) !important;
      color: #fff !important;
      font-weight: bold;
      animation: glow 2s infinite alternate;
      position: relative;
    }

    .current-period::after {
      content: " 👈 ATUAL";
      font-size: 0.8rem;
      margin-left: 10px;
    }

    .future-period {
      background: rgba(68, 68, 68, 0.5);
      color: #999;
    }

    .past-period {
      background: rgba(255, 68, 68, 0.1);
      color: #ff6b6b;
    }

    .completion-info {
      background: linear-gradient(45deg, #0af, #08c) !important;
      color: #000 !important;
      font-weight: bold;
    }

    @keyframes glow {
      from { box-shadow: 0 0 20px rgba(40, 167, 69, 0.6); }
      to { box-shadow: 0 0 30px rgba(40, 167, 69, 0.9); }
    }

    .status-legend {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: bold;
    }

    .legend-current {
      background: linear-gradient(45deg, #28a745, #20c997);
      color: #fff;
    }

    .legend-future {
      background: rgba(68, 68, 68, 0.5);
      color: #ccc;
    }

    .legend-past {
      background: rgba(255, 68, 68, 0.2);
      color: #ff6b6b;
    }

    /* Profile Edit Styles */
    .perfil-form {
      max-width: 600px;
      margin: 0 auto;
      background: rgba(17, 17, 17, 0.9);
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 8px 25px rgba(0,170,255,0.2);
      border: 1px solid rgba(0,170,255,0.3);
      backdrop-filter: blur(10px);
    }
    
    .perfil-form h2 {
      text-align: center;
      margin-bottom: 30px;
      color: #0af;
      text-shadow: 0 0 10px rgba(0,170,255,0.5);
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #0af;
      font-weight: bold;
    }
    
    .form-group input, .form-group select {
      width: 100%;
      padding: 12px;
      background: rgba(34, 34, 34, 0.8);
      border: 2px solid rgba(0,170,255,0.3);
      border-radius: 8px;
      color: #0af;
      font-size: 1rem;
      transition: all 0.3s ease;
      box-sizing: border-box;
    }
    
    .form-group input:focus, .form-group select:focus {
      outline: none;
      border-color: #0af;
      box-shadow: 0 0 10px rgba(0,170,255,0.3);
      background: rgba(51, 51, 51, 0.9);
    }
    
    .photo-upload {
      text-align: center;
      margin-bottom: 25px;
    }
    
    .current-photo {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      margin: 0 auto 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(45deg, #0af, #08c);
      color: #000;
      font-weight: bold;
      font-size: 3rem;
      overflow: hidden;
      border: 4px solid rgba(0,170,255,0.5);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .current-photo:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(0,170,255,0.4);
    }
    
    .current-photo img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .save-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(45deg, #0af, #08c);
      border: none;
      border-radius: 8px;
      color: #000;
      font-weight: bold;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 10px;
    }
    
    .save-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,170,255,0.4);
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8);
      backdrop-filter: blur(5px);
    }
    
    .modal-content {
      background: rgba(17, 17, 17, 0.95);
      margin: 5% auto;
      padding: 30px;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 10px 30px rgba(0,170,255,0.3);
      border: 2px solid rgba(0,170,255,0.3);
      position: relative;
      backdrop-filter: blur(10px);
    }
    
    .close {
      position: absolute;
      right: 20px;
      top: 15px;
      color: #0af;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      transition: color 0.3s ease;
    }
    
    .close:hover {
      color: #ff4444;
    }
    
    .modal h3 {
      color: #0af;
      margin-bottom: 20px;
      text-align: center;
    }
    
    .modal input, .modal select {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      background: rgba(34, 34, 34, 0.8);
      border: 2px solid rgba(0,170,255,0.3);
      border-radius: 8px;
      color: #0af;
      box-sizing: border-box;
    }
    
    .modal-buttons {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    .modal-buttons button {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .btn-confirm {
      background: linear-gradient(45deg, #0af, #08c);
      color: #000;
    }
    
    .btn-cancel {
      background: linear-gradient(45deg, #666, #555);
      color: #fff;
    }

    /* PDF Viewer Modal */
    .pdf-viewer-modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.9);
      backdrop-filter: blur(5px);
    }

    .pdf-viewer-content {
      background: rgba(17, 17, 17, 0.95);
      margin: 2% auto;
      padding: 20px;
      border-radius: 15px;
      width: 95%;
      height: 90%;
      max-width: 1200px;
      box-shadow: 0 10px 30px rgba(0,170,255,0.3);
      border: 2px solid rgba(0,170,255,0.3);
      position: relative;
      backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
    }

    .pdf-viewer-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid rgba(0,170,255,0.3);
    }

    .pdf-viewer-header h3 {
      color: #0af;
      margin: 0;
    }

    .pdf-frame {
      flex: 1;
      border: 2px solid rgba(0,170,255,0.3);
      border-radius: 10px;
      background: #fff;
    }
    
    @media (max-width: 768px) {
      .items-grid {
        justify-content: center;
      }
      
      .quiz-card, .user-card, .pdf-card {
        width: 90%;
        max-width: 350px;
      }
      
      #tabs {
        justify-content: center;
      }
      
      .section-title {
        flex-direction: column;
        gap: 15px;
      }

      header {
        flex-direction: column;
        gap: 20px;
        text-align: center;
      }

      .header-buttons {
        justify-content: center;
      }

      .calendar-container {
        padding: 15px;
      }

      .calendar-table {
        font-size: 0.8rem;
      }

      .calendar-table th,
      .calendar-table td {
        padding: 8px 6px;
      }

      .status-legend {
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="particles"></div>
  
  <header>
    <h1>🧠 BrainQuiz - Painel</h1>
    <div class="header-buttons">
      <button id="createQuizBtn" title="Criar novo quiz">📝 Criar Quiz</button>
      <button id="exitBtn" title="Sair do sistema">🚪 Sair</button>
    </div>
  </header>
  
  <div id="tabs">
    <button class="tab-button active" data-tab="ativos">🎯 Quizzes Ativos</button>
    <button class="tab-button" data-tab="arquivados">📁 Arquivados</button>
    <button class="tab-button" data-tab="excluidos">🗑️ Excluídos</button>
    <button class="tab-button" data-tab="usuarios">👥 Usuários</button>
    <button class="tab-button" data-tab="cadastros">⏳ Cadastros Pendentes</button>
    <button class="tab-button" data-tab="pdfs">📄 PDFs</button>
    <button class="tab-button" data-tab="calendario">📅 Calendário</button>
    <button class="tab-button" data-tab="perfil">👤 Meu Perfil</button>
  </div>

  <main id="mainContainer">
    <div id="quizzesContainer"></div>
  </main>

  <div id="mensagemSucesso"></div>

  <!-- PDF Viewer Modal -->
  <div id="pdfViewerModal" class="pdf-viewer-modal">
    <div class="pdf-viewer-content">
      <div class="pdf-viewer-header">
        <h3 id="pdfViewerTitle">Visualizar PDF</h3>
        <span class="close" onclick="closePdfViewer()">&times;</span>
      </div>
      <iframe id="pdfFrame" class="pdf-frame" src=""></iframe>
    </div>
  </div>

  <!-- Modais -->
  <div id="editUserModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>✏️ Editar Usuário</h3>
      <input type="text" id="editUserName" placeholder="Nome">
      <input type="text" id="editUserEmail" placeholder="Email">
      <input type="text" id="editUserPhone" placeholder="Telefone">
      <select id="editUserType">
        <option value="aluno">Aluno</option>
        <option value="moderador">Moderador</option>
        <option value="administrador">Administrador</option>
      </select>
      <div class="modal-buttons">
        <button class="btn-confirm" onclick="saveUserEdit()">💾 Salvar</button>
        <button class="btn-cancel" onclick="closeModal('editUserModal')">❌ Cancelar</button>
      </div>
    </div>
  </div>

  <div id="changePasswordModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>🔑 Alterar Senha</h3>
      <input type="password" id="newPassword" placeholder="Nova senha">
      <input type="password" id="confirmPassword" placeholder="Confirmar senha">
      <div class="modal-buttons">
        <button class="btn-confirm" onclick="changeUserPassword()">🔄 Alterar</button>
        <button class="btn-cancel" onclick="closeModal('changePasswordModal')">❌ Cancelar</button>
      </div>
    </div>
  </div>

  <div id="profilePasswordModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3>🔐 Confirmar Senha</h3>
      <p style="color: #0af; margin-bottom: 20px;">Digite sua senha atual para salvar as alterações:</p>
      <input type="password" id="currentPassword" placeholder="Senha atual">
      <div class="modal-buttons">
        <button class="btn-confirm" onclick="confirmProfileSave()">✅ Confirmar</button>
        <button class="btn-cancel" onclick="closeModal('profilePasswordModal')">❌ Cancelar</button>
      </div>
    </div>
  </div>

  <input type="file" id="fileInput" accept=".pdf" style="display: none;">
  <input type="file" id="profilePhotoInput" accept="image/*" style="display: none;">

<script>
console.log('🚀 DASHBOARD SINCRONIZADO v5.1 - Sistema Real com Backend');

// ============================================================================
// VARIABLES GLOBAIS - SISTEMA REAL
// ============================================================================

let usuarioLogado = null;
let users = [];
let cadastros = [];
let quizzes = [];
let quizzesArquivados = [];
let quizzesExcluidos = [];
let pdfs = [];
let pdfsExcluidos = [];
let currentTab = 'ativos';
let currentEditingUser = null;
let pendingProfileData = null;

const quizzesContainer = document.getElementById('quizzesContainer');
const createQuizBtn = document.getElementById('createQuizBtn');
const exitBtn = document.getElementById('exitBtn');
const mensagemSucesso = document.getElementById('mensagemSucesso');

// ============================================================================
// EFEITOS VISUAIS - MANTIDOS TODOS
// ============================================================================

function criarParticulas() {
  const container = document.querySelector('.particles');
  
  setInterval(() => {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = Math.random() * 100 + 'vw';
    particle.style.animationDelay = Math.random() * 2 + 's';
    container.appendChild(particle);
    
    setTimeout(() => {
      if (particle.parentNode) {
        particle.parentNode.removeChild(particle);
      }
    }, 8000);
  }, 500);
}

// ============================================================================
// SISTEMA DE AUTENTICAÇÃO REAL - CORRIGIDO
// ============================================================================

async function verificarUsuarioLogado() {
  console.log('🔍 Verificando sessão do usuário...');
  
  try {
    // CORRIGIDO: Usar URL relativa ao backend
    const response = await fetch('https://brainquiz-backend.onrender.com/usuario', {
      method: 'GET',
      credentials: 'include'
    });
    
    if (response.ok) {
      const data = await response.json();
      if (data.success && data.usuario) {
        usuarioLogado = data.usuario;
        console.log('✅ Usuário autenticado:', usuarioLogado.usuario);
        return true;
      }
    }
    
    // Se chegou aqui, não está autenticado
    console.log('❌ Usuário não autenticado, redirecionando...');
    window.location.href = 'index.html'; // CORRIGIDO: sem barra inicial
    return false;
    
  } catch (error) {
    console.error('❌ Erro ao verificar sessão:', error);
    window.location.href = 'index.html'; // CORRIGIDO: sem barra inicial
    return false;
  }
}

// ============================================================================
// CARREGAMENTO DE DADOS REAIS DO BACKEND - CORRIGIDO
// ============================================================================

async function carregarDadosReais() {
  console.log('📡 Carregando dados reais do backend...');
  
  try {
    // Carregar usuários
    const usuariosResponse = await fetch('https://brainquiz-backend.onrender.com/api/usuarios', {
      method: 'GET',
      credentials: 'include'
    });
    
    if (usuariosResponse.ok) {
      const usuariosData = await usuariosResponse.json();
      users = usuariosData.usuarios || [];
      console.log('✅ Usuários carregados:', users.length);
    }
    
    // Carregar cadastros pendentes
    const cadastrosResponse = await fetch('https://brainquiz-backend.onrender.com/api/cadastros', {
      method: 'GET',
      credentials: 'include'
    });
    
    if (cadastrosResponse.ok) {
      const cadastrosData = await cadastrosResponse.json();
      cadastros = cadastrosData.cadastros || [];
      console.log('✅ Cadastros pendentes:', cadastros.length);
    }
    
    // Carregar quizzes ativos
    const quizzesResponse = await fetch('https://brainquiz-backend.onrender.com/api/quizzes', {
      method: 'GET',
      credentials: 'include'
    });
    
    if (quizzesResponse.ok) {
      const quizzesData = await quizzesResponse.json();
      quizzes = quizzesData.quizzes || [];
      console.log('✅ Quizzes ativos:', quizzes.length);
    }
    
    // Carregar quizzes arquivados (só admin/moderador)
    if (usuarioLogado.tipo === 'administrador' || usuarioLogado.tipo === 'moderador') {
      const arquivadosResponse = await fetch('https://brainquiz-backend.onrender.com/api/quizzes/arquivados', {
        method: 'GET',
        credentials: 'include'
      });
      
      if (arquivadosResponse.ok) {
        const arquivadosData = await arquivadosResponse.json();
        quizzesArquivados = arquivadosData.quizzes || [];
        console.log('✅ Quizzes arquivados:', quizzesArquivados.length);
      }
    }
    
    // Carregar quizzes excluídos (só admin)
    if (usuarioLogado.tipo === 'administrador') {
      const excluidosResponse = await fetch('https://brainquiz-backend.onrender.com/api/quizzes/excluidos', {
        method: 'GET',
        credentials: 'include'
      });
      
      if (excluidosResponse.ok) {
        const excluidosData = await excluidosResponse.json();
        quizzesExcluidos = excluidosData.quizzes || [];
        console.log('✅ Quizzes excluídos:', quizzesExcluidos.length);
      }
    }
    
    // Carregar PDFs
    const pdfsResponse = await fetch('https://brainquiz-backend.onrender.com/api/pdfs', {
      method: 'GET',
      credentials: 'include'
    });
    
    if (pdfsResponse.ok) {
      const pdfsData = await pdfsResponse.json();
      pdfs = pdfsData.pdfs || [];
      console.log('✅ PDFs carregados:', pdfs.length);
    }
    
    console.log('✅ Todos os dados carregados com sucesso');
    
  } catch (error) {
    console.error('❌ Erro ao carregar dados:', error);
    mostrarMensagemSucesso('⚠️ Erro ao carregar alguns dados. Tentando novamente...');
  }
}

// ============================================================================
// CONFIGURAÇÃO DOS BOTÕES PRINCIPAIS - CORRIGIDA
// ============================================================================

function configurarBotoesPrincipais() {
  console.log('⚙️ Configurando botões principais...');
  
  const podecriarQuiz = validarPermissao('criar_quiz');
  
  if (podecriarQuiz) {
    createQuizBtn.style.display = 'inline-block';
    createQuizBtn.onclick = () => {
      console.log('🔄 Redirecionando para criação de quiz...');
      window.location.href = 'painel.html'; // CORRIGIDO: sem barra inicial
    };
  } else {
    createQuizBtn.style.display = 'none';
  }

  // BOTÃO SAIR CORRIGIDO - SEMPRE USA BACKEND
  exitBtn.onclick = async () => {
    if (confirm('Deseja realmente sair do sistema?')) {
      console.log('👋 Fazendo logout...');
      
      try {
        // Fazer logout no backend
        const response = await fetch('https://brainquiz-backend.onrender.com/logout', {
          method: 'POST',
          credentials: 'include'
        });
        
        if (response.ok) {
          console.log('✅ Logout realizado no backend');
        }
      } catch (error) {
        console.error('⚠️ Erro no logout backend:', error);
      }
      
      // Limpar qualquer localStorage (compatibilidade)
      localStorage.clear();
      
      // Redirecionar para index.html
      console.log('🔄 Redirecionando para index.html...');
      window.location.href = 'index.html'; // CORRIGIDO: sem barra inicial
    }
  };
}
